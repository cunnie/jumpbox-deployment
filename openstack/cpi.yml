---
- type: replace
  path: /releases/-
  value:
    name: "bosh-openstack-cpi"
    version: "39"
    url: "https://bosh.io/d/github.com/cloudfoundry-incubator/bosh-openstack-cpi-release?v=39"
    sha1: "23d565ae5a90c0889e9832354589221ee8d41695"

- type: replace
  path: /resource_pools/name=vms/stemcell?
  value:
    url: https://bosh.io/d/stemcells/bosh-openstack-kvm-ubuntu-xenial-go_agent-raw?v=87.3
    sha1: 8c9bbfdf5f8e51e4e7aa906ee462d61d7b74ed55 \

# Configure sizes
- type: replace
  path: /resource_pools/name=vms/cloud_properties?
  value:
    instance_type: m1.small
    availability_zone: ((az))

- type: replace
  path: /networks/name=private/subnets/0/cloud_properties?
  value:
    net_id: ((net_id))

# Add CPI job
- type: replace
  path: /cloud_provider/template?
  value:
    name: openstack_cpi
    release: bosh-openstack-cpi

- type: replace
  path: /cloud_provider/ssh_tunnel?
  value:
    host: ((external_ip))
    port: 22
    user: vcap
    private_key: ((private_key))

- type: replace
  path: /cloud_provider/properties/openstack?
  value:
    auth_url: ((auth_url))
    username: ((openstack_username))
    api_key: ((openstack_password))
    tenant: ((tenant))
    region: ((region))
    default_key_name: ((default_key_name))
    default_security_groups: ((default_security_groups))
